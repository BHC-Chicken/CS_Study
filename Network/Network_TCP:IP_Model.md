# ✏️ TCP/IP 4계층 모델

> #### TCP/IP 모델이란?
> - 인터넷에서 각 노드간 통신규약의 집합인 *인터넷 프로토콜 스위트(Internet protocol suite)를 계층형 모델로 설명한 것
> - 주로 OSI 모델과 TCP/IP 모델로 설명

## 1. 계층 구조와 각 계층별 대표적인 프토로콜

### 1.1 각 계층별 대표적인 통신 프로토콜

-	애플리케이션 계층
	-	FTP / HTTP / SSH / SMTP / DNS 등
-	전송 계층
	-	TCP / UDP / QUIC 등
-	인터넷 계층
	-	IP / ARP / ICMP 등
-	링크 계층
	-	Ethernet / 시리얼 통신 등

### 1.2 계층 구조

-	**애플리케이션 계층**
	-	FTP, HTTP, SSH, DNS 등 응용프로그램이 사용되는 계층
	-	웹서비스, 이메일 등 실질적인 클라이언트 서비스

> - FTP : 장치 간 파일전송 표준 프로토콜
> - SSH : 보안되지 않은 네트워크를 안전하게 운영하기위한 암호화 프로토콜
> - HTTP : World Wide Web을 위한 데이터 통신의 기초, 웹사이트 서비스 제공 프로토콜
> - SMTP : 인터넷 전자메일 전송 표준 프로토콜
> - DNS : 도메인이름과 IP주소를 매핑

-	**전송 계층**
	-	데이터의 송수신자를 연결하는 서비스 제공
	-	애플리케이션과 인터넷계층 사이 중계 역할
	-	대표적으로 TCP와 UDP
> #### 패킷 교환 Packet Switching
> - 가상회선 패킷 교환 방식 Virtual Circuit
>   - 패킷간 순서 보장
>   - 각 패킷이 같은 경로로 이동
>   - 수신 여부 확인
> - 데이터그램 패킷 교환 방식 Datagram
>   - 패킷간 순서가 바뀔 수 있음
>   - 각 패킷의 이동경로가 다를 수 있음
>   - 수신 여부를 확인하지 않음

> #### TCP 링크 성립 과정
> - `3-Way Handshake` : 데이터 전송 전 신뢰성 구축 단계
>   - 1. `SYN` : A노드에서 B노드로 TCP연결 요청 패킷(ISN) 송신
>   - 2. `SYM+ACK` : A노드의 ISN을 수신한 B노드가 B노드의 ISN과 승인번호(A노드의 ISN + 1) 송신
>   - 3. `ACK` : A노드가 B노드로 승인번호(B노드의 ISN + 1) 송신

> #### TCP 링크 해제 과정
> - `4-Way Handshake` : 지연패킷 등 데이터 무결성 대비
>   - A노드에서 B노드로 `FIN` 세그먼트 송신 후 일정 시간동안`FIN_WAIT` 상태로 전환
>   - `FIN` 세그먼트를 수신한 B 노드가 `ACK` 세그먼트 전송 후 일정 시간동안 `CLOSE_WAIT` 상태로 전환
>   - 설정된 `CLOSE_WAIT` 시간 경과 후 `FIN` 세그먼트 전송, `TIME_WAIT` 상태로 전환
>   - A노드에서 `FIN` 수신 후 `ACK` 세그먼트 전송
>   - 연결 해제

-	**인터넷 계층**
	-	장치로부터 받은 네트워크 패킷을 지정된 목적지로 전송하는 계층
	-	IP, ARP, ICMP 등
	-	데이터를 뿌리는 형태, 데이터 수신여부를 확인하지 않음

-	**링크 계층**
	-	물리적 유/무선 링크
	-	실직적인 데이터 전달 담당
	-	~= 네트워크 접근계층
	-	대표적으로 유/무선 LAN 프로토콜
> - 유선 LAN 
>   - 송수신 경로를 나누어 전이중화 통신 사용 Full Duplex
>   - 통신하는 양쪽 장치가 동시에 데이터 송수신 가능
> - 무선 LAN
>   - 송수신 경로가 같아 반이중화 통신 사용 Half Duplex
>   - 한번에 한 방향으로만 통신 가능
```
무선 통신 주파수에 관해...

 데이터 송수신에 사용되는 주파수는 데이터 잡음저항성, 장애물 저항성 등 여러가지 영향이 있다
 저주파일 수록 장애물에 강하고 멀리 보낼 수 있지만 잡음 저항성이 떨어짐
```

```
캡슐화된 이더넷 프레임 구조 

 Preamble : 이더넷 프레임의 시작 / 7 Byte
 SFD(Start Frame Delimiter) : Preamble과 MAC 주소 필드 간 간격 / 1 Byte
 DMAC, SMAC : 각각 수신, 송신 MAC 주소 / 각각 6 Byte
 EtherType : 데이터 계층 위 IP 프로토콜 정의 IPv4, IPv6 등 / 2 Byte
 Payload : 전달받은 데이터
 CRC : 에러 확인 비트 / 4 Byte
```

## 2. 계층간 데이터 송수신 과정

### 2.1 캡슐화 Encapsulation
-	상위계층의 헤더와 데이터를 데이터부분에 포함, 헤더를 붙이는 과정
-	링크 계층에서는 프레임 헤더를 붙이고 프레임 트레일러를 붙임
### 2.2 역캡슐화 Decapsulation
-	캡슐화 과정의 역순

```
```